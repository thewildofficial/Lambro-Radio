// frontend/src/lib/theme-manager.js

export const solfeggioThemes = {
  174: { // Deep Red
    '--theme-bg-primary': 'hsl(0, 60%, 10%)',
    '--theme-bg-secondary': 'hsl(0, 55%, 15%)',
    '--theme-text-primary': 'hsl(0, 10%, 90%)',
    '--theme-text-secondary': 'hsl(0, 5%, 70%)',
    '--theme-accent': 'hsl(0, 70%, 50%)',
    '--theme-accent-hover': 'hsl(0, 70%, 60%)',
    '--theme-border': 'hsl(0, 60%, 20%)',
    '--theme-card-bg': 'hsl(0, 50%, 12%)',
    '--theme-input-bg': 'hsl(0, 50%, 8%)',
    '--theme-button-bg': 'hsl(0, 70%, 45%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(0, 60%, 25%)',
    '--theme-slider-thumb': 'hsl(0, 70%, 50%)',
    '--theme-toggle-bg': 'hsl(0, 50%, 18%)',
    '--theme-toggle-bg-hover': 'hsl(0, 50%, 22%)',
    '--theme-toggle-item-bg': 'hsl(0, 60%, 30%)',
    '--theme-toggle-item-bg-selected': 'hsl(0, 70%, 50%)',
    '--theme-toggle-item-text': 'hsl(0, 10%, 85%)',
    '--theme-header-gradient-from': 'hsl(0, 70%, 40%)',
    '--theme-header-gradient-to': 'hsl(0, 80%, 55%)',
    '--theme-wave-color': 'hsla(0, 40%, 60%, 0.5)',
    '--theme-wave-progress': 'hsla(0, 70%, 55%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 100%, 95%, 0.9)',
    '--theme-page-background': 'hsl(0, 60%, 5%)',
  },
  285: { // Orange-Red
    '--theme-bg-primary': 'hsl(15, 60%, 10%)',
    '--theme-bg-secondary': 'hsl(15, 55%, 15%)',
    '--theme-text-primary': 'hsl(15, 10%, 90%)',
    '--theme-text-secondary': 'hsl(15, 5%, 70%)',
    '--theme-accent': 'hsl(15, 70%, 50%)',
    '--theme-accent-hover': 'hsl(15, 70%, 60%)',
    '--theme-border': 'hsl(15, 60%, 20%)',
    '--theme-card-bg': 'hsl(15, 50%, 12%)',
    '--theme-input-bg': 'hsl(15, 50%, 8%)',
    '--theme-button-bg': 'hsl(15, 70%, 45%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(15, 60%, 25%)',
    '--theme-slider-thumb': 'hsl(15, 70%, 50%)',
    '--theme-toggle-bg': 'hsl(15, 50%, 18%)',
    '--theme-toggle-bg-hover': 'hsl(15, 50%, 22%)',
    '--theme-toggle-item-bg': 'hsl(15, 60%, 30%)',
    '--theme-toggle-item-bg-selected': 'hsl(15, 70%, 50%)',
    '--theme-toggle-item-text': 'hsl(15, 10%, 85%)',
    '--theme-header-gradient-from': 'hsl(15, 70%, 40%)',
    '--theme-header-gradient-to': 'hsl(15, 80%, 55%)',
    '--theme-wave-color': 'hsla(15, 40%, 60%, 0.5)',
    '--theme-wave-progress': 'hsla(15, 70%, 55%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(15, 60%, 5%)',
  },
  396: { // Red-Orange
    '--theme-bg-primary': 'hsl(30, 65%, 10%)',
    '--theme-bg-secondary': 'hsl(30, 60%, 15%)',
    '--theme-text-primary': 'hsl(30, 15%, 90%)',
    '--theme-text-secondary': 'hsl(30, 10%, 70%)',
    '--theme-accent': 'hsl(30, 75%, 50%)',
    '--theme-accent-hover': 'hsl(30, 75%, 60%)',
    '--theme-border': 'hsl(30, 65%, 20%)',
    '--theme-card-bg': 'hsl(30, 55%, 12%)',
    '--theme-input-bg': 'hsl(30, 55%, 8%)',
    '--theme-button-bg': 'hsl(30, 75%, 45%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(30, 65%, 25%)',
    '--theme-slider-thumb': 'hsl(30, 75%, 50%)',
    '--theme-toggle-bg': 'hsl(30, 55%, 18%)',
    '--theme-toggle-bg-hover': 'hsl(30, 55%, 22%)',
    '--theme-toggle-item-bg': 'hsl(30, 65%, 30%)',
    '--theme-toggle-item-bg-selected': 'hsl(30, 75%, 50%)',
    '--theme-toggle-item-text': 'hsl(30, 15%, 85%)',
    '--theme-header-gradient-from': 'hsl(30, 75%, 40%)',
    '--theme-header-gradient-to': 'hsl(30, 85%, 55%)',
    '--theme-wave-color': 'hsla(30, 50%, 60%, 0.5)',
    '--theme-wave-progress': 'hsla(30, 75%, 55%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(30, 65%, 5%)',
  },
  417: { // Orange
    '--theme-bg-primary': 'hsl(39, 70%, 12%)',
    '--theme-bg-secondary': 'hsl(39, 65%, 18%)',
    '--theme-text-primary': 'hsl(39, 20%, 92%)',
    '--theme-text-secondary': 'hsl(39, 15%, 75%)',
    '--theme-accent': 'hsl(39, 80%, 55%)',
    '--theme-accent-hover': 'hsl(39, 80%, 65%)',
    '--theme-border': 'hsl(39, 70%, 25%)',
    '--theme-card-bg': 'hsl(39, 60%, 15%)',
    '--theme-input-bg': 'hsl(39, 60%, 10%)',
    '--theme-button-bg': 'hsl(39, 80%, 50%)',
    '--theme-button-text': 'hsl(39, 80%, 5%)',
    '--theme-slider-track': 'hsl(39, 70%, 30%)',
    '--theme-slider-thumb': 'hsl(39, 80%, 55%)',
    '--theme-toggle-bg': 'hsl(39, 60%, 20%)',
    '--theme-toggle-bg-hover': 'hsl(39, 60%, 25%)',
    '--theme-toggle-item-bg': 'hsl(39, 70%, 35%)',
    '--theme-toggle-item-bg-selected': 'hsl(39, 80%, 55%)',
    '--theme-toggle-item-text': 'hsl(39, 20%, 88%)',
    '--theme-header-gradient-from': 'hsl(39, 80%, 45%)',
    '--theme-header-gradient-to': 'hsl(39, 90%, 60%)',
    '--theme-wave-color': 'hsla(39, 55%, 65%, 0.5)',
    '--theme-wave-progress': 'hsla(39, 80%, 60%, 0.8)',
    '--theme-wave-cursor': 'hsla(39, 100%, 5%, 0.9)',
    '--theme-page-background': 'hsl(39, 70%, 7%)',
  },
  528: { // Green (Golden-Green/Emerald)
    '--theme-bg-primary': 'hsl(120, 40%, 10%)',
    '--theme-bg-secondary': 'hsl(120, 35%, 15%)',
    '--theme-text-primary': 'hsl(120, 10%, 90%)',
    '--theme-text-secondary': 'hsl(120, 5%, 70%)',
    '--theme-accent': 'hsl(120, 60%, 45%)',
    '--theme-accent-hover': 'hsl(120, 60%, 55%)',
    '--theme-border': 'hsl(120, 40%, 20%)',
    '--theme-card-bg': 'hsl(120, 30%, 12%)',
    '--theme-input-bg': 'hsl(120, 30%, 8%)',
    '--theme-button-bg': 'hsl(120, 60%, 40%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(120, 40%, 25%)',
    '--theme-slider-thumb': 'hsl(120, 60%, 45%)',
    '--theme-toggle-bg': 'hsl(120, 30%, 18%)',
    '--theme-toggle-bg-hover': 'hsl(120, 30%, 22%)',
    '--theme-toggle-item-bg': 'hsl(120, 40%, 30%)',
    '--theme-toggle-item-bg-selected': 'hsl(120, 60%, 45%)',
    '--theme-toggle-item-text': 'hsl(120, 10%, 85%)',
    '--theme-header-gradient-from': 'hsl(120, 60%, 35%)',
    '--theme-header-gradient-to': 'hsl(120, 70%, 50%)',
    '--theme-wave-color': 'hsla(120, 30%, 55%, 0.5)',
    '--theme-wave-progress': 'hsla(120, 60%, 50%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(120, 40%, 5%)',
  },
  639: { // Pink/Rose
    '--theme-bg-primary': 'hsl(330, 50%, 12%)',
    '--theme-bg-secondary': 'hsl(330, 45%, 18%)',
    '--theme-text-primary': 'hsl(330, 15%, 92%)',
    '--theme-text-secondary': 'hsl(330, 10%, 75%)',
    '--theme-accent': 'hsl(330, 65%, 55%)',
    '--theme-accent-hover': 'hsl(330, 65%, 65%)',
    '--theme-border': 'hsl(330, 50%, 25%)',
    '--theme-card-bg': 'hsl(330, 40%, 15%)',
    '--theme-input-bg': 'hsl(330, 40%, 10%)',
    '--theme-button-bg': 'hsl(330, 65%, 50%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(330, 50%, 30%)',
    '--theme-slider-thumb': 'hsl(330, 65%, 55%)',
    '--theme-toggle-bg': 'hsl(330, 40%, 20%)',
    '--theme-toggle-bg-hover': 'hsl(330, 40%, 25%)',
    '--theme-toggle-item-bg': 'hsl(330, 50%, 35%)',
    '--theme-toggle-item-bg-selected': 'hsl(330, 65%, 55%)',
    '--theme-toggle-item-text': 'hsl(330, 15%, 88%)',
    '--theme-header-gradient-from': 'hsl(330, 65%, 45%)',
    '--theme-header-gradient-to': 'hsl(330, 75%, 60%)',
    '--theme-wave-color': 'hsla(330, 40%, 60%, 0.5)',
    '--theme-wave-progress': 'hsla(330, 65%, 60%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(330, 50%, 7%)',
  },
  741: { // Blue
    '--theme-bg-primary': 'hsl(210, 50%, 10%)',
    '--theme-bg-secondary': 'hsl(210, 45%, 15%)',
    '--theme-text-primary': 'hsl(210, 15%, 90%)',
    '--theme-text-secondary': 'hsl(210, 10%, 70%)',
    '--theme-accent': 'hsl(210, 70%, 50%)',
    '--theme-accent-hover': 'hsl(210, 70%, 60%)',
    '--theme-border': 'hsl(210, 50%, 20%)',
    '--theme-card-bg': 'hsl(210, 40%, 12%)',
    '--theme-input-bg': 'hsl(210, 40%, 8%)',
    '--theme-button-bg': 'hsl(210, 70%, 45%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(210, 50%, 25%)',
    '--theme-slider-thumb': 'hsl(210, 70%, 50%)',
    '--theme-toggle-bg': 'hsl(210, 40%, 18%)',
    '--theme-toggle-bg-hover': 'hsl(210, 40%, 22%)',
    '--theme-toggle-item-bg': 'hsl(210, 50%, 30%)',
    '--theme-toggle-item-bg-selected': 'hsl(210, 70%, 50%)',
    '--theme-toggle-item-text': 'hsl(210, 15%, 85%)',
    '--theme-header-gradient-from': 'hsl(210, 70%, 40%)',
    '--theme-header-gradient-to': 'hsl(210, 80%, 55%)',
    '--theme-wave-color': 'hsla(210, 40%, 55%, 0.5)',
    '--theme-wave-progress': 'hsla(210, 70%, 55%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(210, 50%, 5%)',
  },
  852: { // Indigo
    '--theme-bg-primary': 'hsl(255, 45%, 12%)',
    '--theme-bg-secondary': 'hsl(255, 40%, 18%)',
    '--theme-text-primary': 'hsl(255, 15%, 92%)',
    '--theme-text-secondary': 'hsl(255, 10%, 75%)',
    '--theme-accent': 'hsl(255, 60%, 55%)',
    '--theme-accent-hover': 'hsl(255, 60%, 65%)',
    '--theme-border': 'hsl(255, 45%, 25%)',
    '--theme-card-bg': 'hsl(255, 35%, 15%)',
    '--theme-input-bg': 'hsl(255, 35%, 10%)',
    '--theme-button-bg': 'hsl(255, 60%, 50%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(255, 45%, 30%)',
    '--theme-slider-thumb': 'hsl(255, 60%, 55%)',
    '--theme-toggle-bg': 'hsl(255, 35%, 20%)',
    '--theme-toggle-bg-hover': 'hsl(255, 35%, 25%)',
    '--theme-toggle-item-bg': 'hsl(255, 45%, 35%)',
    '--theme-toggle-item-bg-selected': 'hsl(255, 60%, 55%)',
    '--theme-toggle-item-text': 'hsl(255, 15%, 88%)',
    '--theme-header-gradient-from': 'hsl(255, 60%, 45%)',
    '--theme-header-gradient-to': 'hsl(255, 70%, 60%)',
    '--theme-wave-color': 'hsla(255, 35%, 60%, 0.5)',
    '--theme-wave-progress': 'hsla(255, 60%, 60%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(255, 45%, 7%)',
  },
  963: { // Violet / White-Violet
    '--theme-bg-primary': 'hsl(280, 50%, 12%)',
    '--theme-bg-secondary': 'hsl(280, 45%, 18%)',
    '--theme-text-primary': 'hsl(280, 25%, 92%)',
    '--theme-text-secondary': 'hsl(280, 20%, 75%)',
    '--theme-accent': 'hsl(280, 70%, 60%)',
    '--theme-accent-hover': 'hsl(280, 70%, 70%)',
    '--theme-border': 'hsl(280, 50%, 25%)',
    '--theme-card-bg': 'hsl(280, 40%, 15%)',
    '--theme-input-bg': 'hsl(280, 40%, 10%)',
    '--theme-button-bg': 'hsl(280, 70%, 55%)',
    '--theme-button-text': 'hsl(0, 0%, 100%)',
    '--theme-slider-track': 'hsl(280, 50%, 30%)',
    '--theme-slider-thumb': 'hsl(280, 70%, 60%)',
    '--theme-toggle-bg': 'hsl(280, 40%, 20%)',
    '--theme-toggle-bg-hover': 'hsl(280, 40%, 25%)',
    '--theme-toggle-item-bg': 'hsl(280, 50%, 35%)',
    '--theme-toggle-item-bg-selected': 'hsl(280, 70%, 60%)',
    '--theme-toggle-item-text': 'hsl(280, 25%, 88%)',
    '--theme-header-gradient-from': 'hsl(280, 70%, 50%)',
    '--theme-header-gradient-to': 'hsl(280, 80%, 65%)',
    '--theme-wave-color': 'hsla(280, 40%, 65%, 0.5)',
    '--theme-wave-progress': 'hsla(280, 70%, 65%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 95%, 0.9)',
    '--theme-page-background': 'hsl(280, 50%, 7%)',
  },
  'default': { // Default Black/Dark theme (Apple-inspired dark mode base)
    '--theme-bg-primary': 'hsl(0, 0%, 8%)',     // Slightly off-black
    '--theme-bg-secondary': 'hsl(0, 0%, 12%)',  // Slightly lighter for secondary surfaces
    '--theme-text-primary': 'hsl(0, 0%, 95%)',  // Off-white for primary text
    '--theme-text-secondary': 'hsl(0, 0%, 70%)',// Grey for secondary text
    '--theme-accent': 'hsl(207, 90%, 54%)',     // Apple blue
    '--theme-accent-hover': 'hsl(207, 85%, 60%)',// Lighter blue for hover
    '--theme-border': 'hsl(0, 0%, 18%)',        // Dark grey for borders
    '--theme-card-bg': 'hsl(0, 0%, 10%)',       // Darker card background
    '--theme-input-bg': 'hsl(0, 0%, 14%)',      // Input background
    '--theme-button-bg': 'hsl(0, 0%, 20%)',     // Button background
    '--theme-button-text': 'hsl(0, 0%, 95%)',   // Button text
    '--theme-slider-track': 'hsl(0, 0%, 25%)',
    '--theme-slider-thumb': 'hsl(0, 0%, 80%)',
    '--theme-toggle-bg': 'hsl(0, 0%, 15%)',
    '--theme-toggle-bg-hover': 'hsl(0, 0%, 20%)',
    '--theme-toggle-item-bg': 'hsl(0, 0%, 22%)',
    '--theme-toggle-item-bg-selected': 'hsl(207, 90%, 54%)',
    '--theme-toggle-item-text': 'hsl(0, 0%, 80%)',
    '--theme-header-gradient-from': 'hsl(207, 80%, 50%)',
    '--theme-header-gradient-to': 'hsl(280, 70%, 60%)',
    '--theme-wave-color': 'hsla(220, 15%, 60%, 0.5)',
    '--theme-wave-progress': 'hsla(220, 35%, 75%, 0.8)',
    '--theme-wave-cursor': 'hsla(0, 0%, 100%, 0.9)',
    '--theme-page-background': 'hsl(0, 0%, 4%)',
  }
};

/**
 * Apply a theme by frequency value
 * @param {string} frequency - Frequency value as string, or "default"
 * @returns {boolean} - Whether the theme was successfully applied
 */
export function applyTheme(frequency) {
  if (!frequency) return false;
  
  try {
    // Only proceed if we're in a browser environment
    if (typeof window === 'undefined' || !document || !document.documentElement) {
      console.warn('Theme manager: window or document not available (server-side rendering)');
      return false;
    }
    
    // Get the theme variables
    const theme = solfeggioThemes[frequency] || solfeggioThemes['default'];
    
    // Apply theme variables to root element
    const rootStyle = document.documentElement.style;
    Object.entries(theme).forEach(([property, value]) => {
      if (property === '--theme-page-background') {
        document.body.style.setProperty(property, value);
      } else {
        rootStyle.setProperty(property, value);
    }
    });
    
    return true;
  } catch (error) {
    console.error('Error applying theme:', error);
    return false;
  }
}

/**
 * Initialize the theme system with default values
 * @param {string} defaultFrequency - Default frequency to apply
 */
export function initializeTheme(defaultFrequency = 'default') {
  // Execute in the next tick to avoid SSR issues
  setTimeout(() => {
  applyTheme(defaultFrequency);
  }, 0);
}

/**
 * Get current theme values for a given frequency
 * @param {string} frequency - Frequency or "default"
 * @returns {Object} - Theme values for the frequency
 */
export function getCurrentThemeValues(frequency) {
  return solfeggioThemes[frequency] || solfeggioThemes['default'];
}

/**
 * Get computed theme colors for WaveSurfer
 * @returns {Object} - Wave color objects
 */
export function getWaveSurferColors() {
  if (typeof window === 'undefined' || !document) {
    // Fallback for SSR
    return {
      waveColor: 'rgba(148, 163, 184, 0.5)',
      progressColor: 'rgba(56, 189, 248, 0.8)',
      cursorColor: 'rgba(34, 197, 94, 0.9)',
    };
  }
  
  try {
    const styles = getComputedStyle(document.documentElement);
    return {
      waveColor: styles.getPropertyValue('--theme-wave-color').trim() || 'rgba(148, 163, 184, 0.5)',
      progressColor: styles.getPropertyValue('--theme-wave-progress').trim() || 'rgba(56, 189, 248, 0.8)',
      cursorColor: styles.getPropertyValue('--theme-wave-cursor').trim() || 'rgba(34, 197, 94, 0.9)',
    };
  } catch (error) {
    console.error('Error getting WaveSurfer colors:', error);
    return {
      waveColor: 'rgba(148, 163, 184, 0.5)',
      progressColor: 'rgba(56, 189, 248, 0.8)',
      cursorColor: 'rgba(34, 197, 94, 0.9)',
    };
  }
} 